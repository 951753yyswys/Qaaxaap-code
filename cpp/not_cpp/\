#include<bits/stdc++.h>
using namespace std;
int p[100100];
struct car
{
	int d,v,a;
} c[100100];
struct line
{
	double l,r;
} a[100100],b[100100];
int cnt,cnt1;
double e=1e-5;
bool cmp(line x,line y)
{
	if(x.l!=y.l) return x.l<y.l;
	else return x.r<y.r;
}
int main()
{
	ios::sync_with_stdio(0);
	cin.tie(0),cout.tie(0);
	int t;
	cin>>t;
	while(t--)
	{
		int n,m,l,v,ans1=0,ans2=0;
		cin>>n>>m>>l>>v;
		for(int i=1;i<=n;i++) cin>>c[i].d>>c[i].v>>c[i].a;
		for(int i=1;i<=m;i++) cin>>p[i];
		sort(p+1,p+m+1);
		for(int i=1;i<=n;i++)
		{
			double st,en;
			int lst=ans1;
			if(c[i].a==0) if(c[i].v>v) if(c[i].d<=p[m]) ans1++;
			if(c[i].a>0)
			{
				st=c[i].d+max(0.0,(v*v-c[i].v*c[i].v)*1.0/(2.0*c[i].a));
				if(2.0*c[i].a*max(0,p[m]-c[i].d)>v*v) ans1++;
			}
			if(c[i].a<0)
			{
				if(c[i].v<=v) continue;
				en=c[i].d+max(0.0,(v*v-c[i].v*c[i].v)*1.0/(2.0*c[i].a));
				int ew=lower_bound(p+1,p+m+1,en)-p-1;
				if(p[ew]>=c[i].d) ans1++;
			}
		}
		//cout<<l<<endl;
		for(int i=1;i<=n;i++)
		{
			double st,en;
			int flag=0;
			if(c[i].a==0) if(c[i].v>v) if(c[i].d<=p[m]) st=c[i].d,en=l,flag++;
			if(c[i].a>0)
			{
				st=c[i].d+max(0.0,(v*v-c[i].v*c[i].v)*1.0/(2.0*c[i].a));
				if(2.0*c[i].a*max(0,p[m]-c[i].d)>v*v) en=l,flag++;
			}
			if(c[i].a<0)
			{
				if(c[i].v<=v) continue;
				en=c[i].d+max(0.0,(c[i].v*c[i].v-v*v)*1.0/(-2.0*c[i].a));
				int ew=lower_bound(p+1,p+m+1,en)-p-1;
				if(p[ew]>=c[i].d) flag++,st=c[i].d;
			}
			//cout<<cnt<<' '<<a[cnt].l<<' '<<a[cnt].r<<endl;
			if(!flag) continue;
			a[++cnt]={st,en};
			cout<<st<<' '<<en<<endl;
			cout<<a[cnt].l<<' '<<a[cnt].r<<endl;
			//a[i].l=st;
			//a[i].r=en;
		}
		sort(a+1,a+n+1,cmp);
		b[++cnt1]=a[1];
		for(int i=2;i<=cnt;i++) 
		{
			if(b[cnt1].r>=a[i].r) continue;
			b[++cnt1]=a[i];
		}
		int i=1;
		double r=-1;
		while(i<=cnt1)
		{
			if(r>=b[i].l)
			{
				i++;
				continue;
			}
			ans2++;
			r=upper_bound(p+1,p+m+1,b[i].r)-p-1;
			cout<<b[i].l<<' '<<b[i].r<<endl;
		}
		cout<<ans1<<' '<<ans2<<endl;
		//for(int i=1;i<=cnt1;i++) cout<<b[i].l<<' '<<b[i].r<<endl;
		for(int i=1;i<=cnt;i++) cout<<a[i].l<<' '<<a[i].r<<endl;
		//cout<<endl;
	}
	return 0;
}
